\section{Discussion}
\label{sec:discussion}

\subsection{Weaknesses}

The WATSUP protocol as described in this paper still suffers from some existing security issues. Current common implementations of asymmetric encryption schemes are vulnerable to offline attacks \cite{Blumenthal:2007}. Additionally, if the user chooses a weak base password, the base password may be susceptible to offline dictionary attacks. Both of these attacks are only possible if an attacker obtains a nonce encrypted with a client's public key, or the attacker obtains the public key itself. Even with alternate asymmetric encryption algorithms, the attacker can still perform an offline dictionary attack if they also capture the plaintext nonce; the attack would perform a standard dictionary attack but then generate a public key for each candidate password using the WATSUP's protocol. If any public key decrypts the encrypted nonce and results in the unencrypted nonce, the attack knows the correct password. Alternately, with current encryption schemes, man-in-the-middle attacks are still possible with the WATSUP protocol. These weaknesses can be eliminated by using HTTPS, but the user still has some guarantees using HTTP.

Another weakness is a Denial of Service attack against the login protocol. An attacker could rapidly request nonces for a target user. Depending on the server implementation, a request may invalidate previous nonces, so the target may be unable to log in.

The WATSUP protocol also does not protect a user from themselves. In order for the WATSUP protocol to provide portable access to online content, a client's private key is reproducible using the client's username and password for a given host. Therefore, if a client loses their password themselves, through some social engineering attack for example, their accounts will still be vulnerable. This also means that online dictionary attacks are still a threat if clients employ weak base passwords. We do not propose WATSUP as a replacement for good password hygiene. Users should still use good practices, such as different passwords on each site and using high entropy passwords.

As discussed in the conclusion, modern asymmetric encryption schemes are not entirely secure. We recommend development and implementation of stronger asymmetric encryption schemes regardless of which authentication model is widely implemented. We also recommend extending the WATSUP protocol. Under the current implementation of WATSUP, users are not able to verify the identity of a server. Extending the protocol to allow for clients and servers to authenticate each other would be beneficial to users. If a client can verify the identity of a server, it can identify insecure situations and refuse to transmit sensitive data. Additionally, the use of HTTPS to secure all communication channels should be enforced whenever possible.

\subsection{Future Work}

Before WATSUP is ready for public use, it needs to be improved and thoroughly vetted by security experts. A major issue that needs to be fixed is the fact that the protocol relies on the server to produce a cryptographic nonce. Our security model does not allow for trust of the server. Therefore, we propose using POSIX time in milliseconds as a nonce. As long as the ping is greater than one millisecond, and the server is correctly providing the time, this nonce will be unique, and hence adequate for cryptographic use. The client can then audit the server's compliance by ensuring the client's POSIX time and the server's POSIX time match within some generous delta (e.g. 1 day). This could cause an issue if the client's clock is not accurate.

Another pathway that could be explored is that of mutual authentication---a trust-on-first-use system could be put in place. This would provide server authenticity guarantees to the user, which could be critical in the event of HTTPS public key infrastructure compromise. To solve this, one model is that the user saves the server's public key, but this means the user would need to save the server's public key on each of their devices. Another model is that the user signs the server's public key, which the server saves and reissues to the user on each connection, but this makes revocation in the event of server compromise difficult or impossible. In either model, the server would perform authentication similar to the client authentication.

As previously discussed, WATSUP is vulnerable to offline dictionary attacks against the base password if attackers can observe both the encrypted nonce and decrypted nonce. Additionally, properties of asymmetric encryption mean that access to just the encrypted nonce is sufficient for an offline attack. With better cryptography, the WATSUP protocol may be able to avoid these issues by never revealing the encrypted nonce in the first place. Tunneling WATSUP through a secure channel, such as HTTPS, already solves this. However, in situations where HTTPS is not available, it is still important to try to protect users. Any solution needs to follow the core ideas of WATSUP: it must be simple for the server to implement, and it must not rely on trusting the server.

\subsection{Conclusion}

The WATSUP protocol provides usage guarantees for user passwords and reduces the number of points of possible exposure of user passwords. Because the WATSUP protocol never stores or transmits client passwords, users are guaranteed that their cleartext passwords will not be stolen during transit or authentication or from the server. Additionally, this guarantees that remote servers are unable to store cleartext or weakly protected passwords themselves. Users of the WATSUP protocol no longer need to trust a company's security systems to protect their passwords since servers never see cleartext passwords. This mitigates the effect of a data breach.
